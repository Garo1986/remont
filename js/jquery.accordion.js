!function(l){l.fn.magicAccordion=function(h){function a(i){function a(){o=[],s=l('<div class="magic-accordion"></div>'),l("> "+h.headingTag,c).each(function(){var i=l(this),a=[],e=!1;i.nextAll().each(function(){var i=l(this);e||i[0].tagName.toLowerCase()===h.headingTag?e=!0:a.push(i.clone())}),o.push({heading:i.clone(),content:a})})}function e(){for(var i in o){var a,e=o[i].heading.addClass(h.headClass),n=l("<div></div>").addClass(h.bodyClass);for(a in e.appendTo(s),o[i].content)o[i].content[a].appendTo(n);n.appendTo(s)}var t;s.insertAfter(c),l("."+h.bodyClass,s).slideUp(0),l("*",c).each(function(){void 0!==l(this).attr("id")&&(l(this).attr("id").match(/^magic_/)||l(this).attr("id","magic_"+l(this).attr("id")))}),c.hide(),(t=l.Event("created.magic")).sections=o,t.accordion=s,c.trigger(t)}function n(){l("."+h.headClass,s).unbind("click.magic").bind("click.magic",function(i){h.hashTrail&&(d=!1,n=l(this).index(),window.location.hash="slide-"+(0==n?1:n/2+1)),i.preventDefault();function a(){var i=l.Event("closed.magic");i.head=l(this).prev(),i.body=l(this),i.index=Math.floor(l(this).index()/2),c.trigger(i)}var e=l(this);l("."+h.headClass+"."+h.activeClass,s).removeClass(h.activeClass),e.addClass(h.activeClass);var n=l("."+h.bodyClass+":visible",s),i=e.next();n.get(0)!==i.get(0)?i.slideDown({complete:function(){var i=l.Event("opened.magic");i.head=e,i.body=l(this),i.index=Math.floor(l(this).index()/2),c.trigger(i)},duration:h.speed,easing:h.easing}):l("."+h.headClass+"."+h.activeClass,s).removeClass(h.activeClass),n.slideUp({complete:a,duration:h.speed,easing:h.easing}),setTimeout(function(){d=!0},100)}),h.openOnLoad&&!1===r()&&l("."+h.headClass,s).eq(h.openOnLoad-1).trigger("click.magic")}function t(){var i;!d||(i=r())&&l("."+h.headClass,s).eq(i-1).trigger("click.magic")}var s,c=l(i),d=!0,o=[],r=function(){var i=window.location.hash;return!!i.match(/^#slide-[0-9]\d*/)&&Number(i.replace("#slide-",""))};this.unbind=function(){c.is(":visible")||(s.remove(),c.show(),l("*",c).each(function(){void 0!==l(this).attr("id")&&l(this).attr("id",l(this).attr("id").replace(/^magic_/,""))}))},this.rebind=function(){c.is(":visible")&&(a(),e(),n())},this.object=function(){return{accordion:s,sections:o}},a(),e(),n(),h.hashTrail&&d&&((i=r())&&l("."+h.headClass,s).eq(i-1).trigger("click.magic")),l(window).bind("hashchange",t),c.data("magic-accordion",this)}h=l.extend({openOnLoad:1,hashTrail:!1,headingTag:"h2",bodyClass:"body",headClass:"head",activeClass:"active",easing:"linear",speed:200},h);return l(this).each(function(i){new a(this)})}}(jQuery);